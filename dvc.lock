schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/pipeline/st_01_data_ingestionpipeline.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: src/pipeline/st_01_data_ingestionpipeline.py
      hash: md5
      md5: 24a72ebb62f212ee557ab381d12b4f29
      size: 923
    outs:
    - path: data/data_ingestion/extracted_files
      hash: md5
      md5: e88f08ab795c660fba778d4eb3ef65ca.dir
      size: 12207807
      nfiles: 390
  data_splitting:
    cmd: python src/pipeline/st_02_data_splittingpipeline.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: params.yaml
      hash: md5
      md5: 2172ae4a7219c6ed882b33d51e21915d
      size: 542
    - path: src/pipeline/st_02_data_splittingpipeline.py
      hash: md5
      md5: 5dc6c730be54f2317ec96068d1499ba9
      size: 814
    params:
      params.yaml:
        ratio: (.7, 0.15,0.15)
    outs:
    - path: data/data_splitting/test
      hash: md5
      md5: f48d8d0e77dda267cc87d3c72d0222a4.dir
      size: 1805148
      nfiles: 60
    - path: data/data_splitting/train
      hash: md5
      md5: 0a81689b7f1be78e7196195260fc7b4b.dir
      size: 8564062
      nfiles: 272
    - path: data/data_splitting/val
      hash: md5
      md5: 403f922992e120f6884e30f08857cba1.dir
      size: 1838597
      nfiles: 58
  data_augmentation:
    cmd: python src/pipeline/st_03_data_aug.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: params.yaml
      hash: md5
      md5: 2172ae4a7219c6ed882b33d51e21915d
      size: 542
    - path: src/pipeline/st_03_data_aug.py
      hash: md5
      md5: 729b330cbd6a976fd695c871c50b9b92
      size: 783
    params:
      params.yaml:
        AUGMENTATION.height_shift_range: 0.2
        AUGMENTATION.horizontal_flip: true
        AUGMENTATION.rotation_range: 90
        AUGMENTATION.shear_range: 0.2
        AUGMENTATION.target_size:
        - 224
        - 224
        AUGMENTATION.vertical_flip: true
        AUGMENTATION.width_shift_range: 0.2
        AUGMENTATION.zoom_range: 0.2
    outs:
    - path: data/data_augmented/test
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: data/data_augmented/train
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: data/data_augmented/val
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  model_building:
    cmd: python src/pipeline/st_04_model_building.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: params.yaml
      hash: md5
      md5: 2172ae4a7219c6ed882b33d51e21915d
      size: 542
    - path: src/pipeline/st_04_model_building.py
      hash: md5
      md5: 50f0875d7bc820dc3da8feca1880cd58
      size: 759
    params:
      params.yaml:
        Model_Building.activation: softmax
        Model_Building.input_shape:
        - 224
        - 224
        - 3
        Model_Building.units: 2
    outs:
    - path: data/model_building/Chicken_fecal.keras
      hash: md5
      md5: 3633003604ccfc44de813261d335e5ce
      size: 59135636
  Model_train_with_Checkpoints:
    cmd: python src/pipeline/st_05_model_with_callbacks.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: params.yaml
      hash: md5
      md5: 2172ae4a7219c6ed882b33d51e21915d
      size: 542
    - path: src/pipeline/st_05_model_with_callbacks.py
      hash: md5
      md5: e24f5b434690ef931ec94736a8130f39
      size: 1169
    params:
      params.yaml:
        Early_stopping.patience: 2
        Early_stopping.restore_best_weights: true
        Model_Checkpoint.monitor: accuracy
        Model_Checkpoint.save_best_only: true
        Model_Checkpoint.save_weights_only: false
        Model_Checkpoint.verbose: 1
        ReduceLROnPlateau.factor: 0.2
        ReduceLROnPlateau.min_lr: 0.0001
    outs:
    - path: data/model_checkpoint/Chicken_fecal_with_callbacks.keras
      hash: md5
      md5: 359a434bf39a6f75fc9a4fd29b0023b7
      size: 59537540
  Model_evaluation:
    cmd: python src/pipeline/st_06_Model_eval.py
    deps:
    - path: config/config.yaml
      hash: md5
      md5: 7c4136d9c22d78e8bb61b09ac5403d4b
      size: 1177
    - path: src/pipeline/st_06_Model_eval.py
      hash: md5
      md5: a379faf6653c5f0c7d50ca35ca4526c0
      size: 935
    outs:
    - path: data/model_evaluation/chicken_score.json
      hash: md5
      md5: 5a7c0d8e1aa115c6f4d88bb50c98c249
      size: 75
